---
id: 3066
title: 'Magpie Vulnerability'
date: '2005-10-27T11:37:00+00:00'
author: Kellan
layout: post
guid: 'http://lm.quxx.info/?p=3066'
permalink: /2005/10/27/magpie-vulnerability/
typo_id:
    - '3064'
mt_id:
    - ''
link_related:
    - 'http://www.sec-consult.com/216.html'
raw_content:
    - "In (hopefully) [unrelated](http://laughingmeme.org/articles/2005/10/27/wordpress-vulnerability-paypal-vulnerability) news, I was just notified that there is a [security vulnerability in Snoopy](http://www.sec-consult.com/216.html), and hence Magpie.  Apparently there is an attack that leverages the fact that Snoopy passes unfiltered arguments to curl that allows for arbitrary code execution.  Here is a note I just sent to the mailing list\r\n\r\n> If you\\'re running Magpie in a context where you allow people to submit\r\nunreviewed URLs, and you have PHP compiled with cURL SSL support then\r\nthis vulnerability effects you.\r\n\r\n> Given a specially crafted (and very simple) URL, an attacker can\r\nexecute arbitrary code in the web server context.  There is no\r\nescalation possibly with this vulnerability, though potentially it\r\ncould be combined with other attacks to allow some sort of permissions\r\nescalation.\r\n\r\n> I\\'ll will release a patch, and a new version this evening unless\r\nsomeone beats me to it. (unfortunately we haven\\'t been given a grace\r\nperiod here)\r\n\r\nIts a variation on the traditional PHP null terminated string attack.  (Does make me wish I had made it to [Chris\\'](http://shiflett.org/) talk when he was here a few weeks ago, rather then being 1 of 3000 people turned away from the Murakami talk at MIT)\r\n\r\n**update 2005-10-28T15:33Z**:  I\\'ve got a [patch](http://laughingmeme.org/code/snoopy_curl_escape.patch) out, waiting for a few people to sanity check it, before rolling out a new release."
tags:
    - magpie
    - php
    - security
    - snoopy
---

In (hopefully) [unrelated](http://laughingmeme.org/articles/2005/10/27/wordpress-vulnerability-paypal-vulnerability) news, I was just notified that there is a [security vulnerability in Snoopy](http://www.sec-consult.com/216.html), and hence Magpie. Apparently there is an attack that leverages the fact that Snoopy passes unfiltered arguments to curl that allows for arbitrary code execution. Here is a note I just sent to the mailing list

> If you’re running Magpie in a context where you allow people to submit unreviewed URLs, and you have PHP compiled with cURL SSL support then this vulnerability effects you.
> 
> Given a specially crafted (and very simple) URL, an attacker can execute arbitrary code in the web server context. There is no escalation possibly with this vulnerability, though potentially it could be combined with other attacks to allow some sort of permissions escalation.
> 
> I’ll will release a patch, and a new version this evening unless someone beats me to it. (unfortunately we haven’t been given a grace period here)

Its a variation on the traditional PHP null terminated string attack. (Does make me wish I had made it to [Chris’](http://shiflett.org/) talk when he was here a few weeks ago, rather then being 1 of 3000 people turned away from the Murakami talk at MIT)

**update 2005-10-28T15:33Z**: I’ve got a [patch](http://laughingmeme.org/code/snoopy*curl*escape.patch) out, waiting for a few people to sanity check it, before rolling out a new release.