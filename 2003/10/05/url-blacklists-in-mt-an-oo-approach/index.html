<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>URL Blacklists in MT: An OO Approach | Kellan Elliott-McCrea: Blog</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="URL Blacklists in MT: An OO Approach" />
<meta name="author" content="Kellan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="After spending 20 minutes banging together mt_honeypot.pl, I decided it was pretty lame. It might end up being of great use, but I doubt it. So I went ahead and implemented URL blacklists. And there goes another exciting Saturday night. (minus the time spent crashing the wedding party next door)" />
<meta property="og:description" content="After spending 20 minutes banging together mt_honeypot.pl, I decided it was pretty lame. It might end up being of great use, but I doubt it. So I went ahead and implemented URL blacklists. And there goes another exciting Saturday night. (minus the time spent crashing the wedding party next door)" />
<link rel="canonical" href="https://laughingmeme.org/2003/10/05/url-blacklists-in-mt-an-oo-approach/" />
<meta property="og:url" content="https://laughingmeme.org/2003/10/05/url-blacklists-in-mt-an-oo-approach/" />
<meta property="og:site_name" content="Kellan Elliott-McCrea: Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2003-10-05T01:58:43+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="URL Blacklists in MT: An OO Approach" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kellan"},"dateModified":"2003-10-05T01:58:43+00:00","datePublished":"2003-10-05T01:58:43+00:00","description":"After spending 20 minutes banging together mt_honeypot.pl, I decided it was pretty lame. It might end up being of great use, but I doubt it. So I went ahead and implemented URL blacklists. And there goes another exciting Saturday night. (minus the time spent crashing the wedding party next door)","headline":"URL Blacklists in MT: An OO Approach","mainEntityOfPage":{"@type":"WebPage","@id":"https://laughingmeme.org/2003/10/05/url-blacklists-in-mt-an-oo-approach/"},"url":"https://laughingmeme.org/2003/10/05/url-blacklists-in-mt-an-oo-approach/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://laughingmeme.org/feed.xml" title="Kellan Elliott-McCrea: Blog" /><style>
    .post-date {
      float: right;
    }
  </style>
  <script defer data-domain="laughingmeme.org" src="https://plausible.io/js/script.js"></script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Kellan Elliott-McCrea: Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="https://kellanem.com/notes/">Leadership notes</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">URL Blacklists in MT:  An OO Approach</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2003-10-05T01:58:43+00:00" itemprop="datePublished">Oct 5, 2003
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Kellan</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>After spending 20 minutes banging together <a href="http://laughingmeme.org/archives/001282.html">mt_honeypot.pl</a>, I decided it was pretty lame. It might end up being of great use, but I doubt it. So I went ahead and implemented URL blacklists. And there goes another exciting Saturday night. (minus the time spent crashing the wedding party next door)</p>

<h3 id="what-i-did">What I Did</h3>

<p>My approach was to write a subclass of <code class="language-plaintext highlighter-rouge">MT::App::Comments</code> called <code class="language-plaintext highlighter-rouge">MT::App::Comments::SpamBad</code>, and then make the tweaks to mt-comments.cgi to call my SpamBad subclass.</p>

<h3 id="how-it-works">How It Works</h3>

<p>SpamBad looks for a directory called <code class="language-plaintext highlighter-rouge">blacklists</code>, and reads the contents of each file in that directory (in case for example you want to use other peoples lists as well as your own), one banned url per line, lines beginning with # are comments. It then compiles those URL into a simple regex which it checks against both the author’s url field, and the body of the comment. (My first reaction was this would be slow, but it isn’t, important to remember this is the kind of thing computers are good at)</p>

<h3 id="installing-it">Installing It</h3>

<ol>
  <li><a href="/code/mt-spambad.tar.gz">Download the tarball.</a></li>
  <li>Backup your mt-comments.cgi</li>
  <li>Copy mt-spambad-comments.cgi to mt-commets.cgi</li>
  <li>Move the spambad dir to somewhere mt-spambad-comments.cgi will be able to find it. (like in the same directory)</li>
  <li>Move the blacklists directory into the same directory as the mt-spambad-comments.cgi</li>
  <li>Test it to make sure its working.</li>
  <li>Start compiling your blacklist, or jump start the process by downloading someone elses.</li>
</ol>

<h3 id="next-steps">Next Steps</h3>

<p>This was a quick hack, not that I’m unhappy with it, but wasn’t the product of weeks of planning, released ‘as is’. I wanted SpamBad to be configurable, I assumed I’d be able to add config options to mt.cfg, but actually <a href="http://moveabletype.org">MoveableType</a> makes it practically impossible. I really like <a href="http://www.kwiki.org">Kwiki’s</a> approach to this, I wish MT would adopt it.</p>

<p>Blacklist checking is just one possible approach, I forsee SpamBad perhaps applying a number of different heuristics, ideally via a plugin architecture. (that was a hint)</p>

<p>A faster scanning technique would be worth considering for future implementations.</p>

<h3 id="lastly">Lastly</h3>

<p>If doing some moderately serious (though it should still upgrade smoothly) surgery on your MT install makes you queasy, you might try <a href="http://www.jayallen.org/journey/2003/09/killing_comment_spam_dead/">this other approach</a>.</p>

  </div><a class="u-url" href="/2003/10/05/url-blacklists-in-mt-an-oo-approach/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">


    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Kellan Elliott-McCrea</li><li><a class="u-email" href="mailto:kellan@gmail.com">kellan@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">
  <li>On Mastodon: <a href="https://fiasco.social/@kellan">@kellan</a></li><li><a href="https://www.twitter.com/kellan"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">kellan</span></a></li><li><a href="https://www.flickr.com/photos/kellan"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#flickr"></use></svg> <span class="username">kellan</span></a></li><li><a href="https://github.com/kellan"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kellan</span></a></li><li><a href="https://www.linkedin.com/in/kellanem"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">kellanem</span></a></li><li><a href="https://kellanem.com/notes/">Leadership blog</a></li>
</ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A personal blog of Kellan Elliott-McCrea. I don&#39;t really know what a &quot;laughing meme&quot; is. It sounded cool in 1999.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
